!function($,window){const LotusUtils={getLocale(pageUrl){if(this.isContributionsPostsPage()||this.isContributionsCommunityCommentsPage()||this.isContributionsCommentsPage())return this.getUrlParameter("locale");const links=(pageUrl||window.location.href).split("/"),hcIndex=links.indexOf("hc");return links[hcIndex+1].split("?")[0].replace("?","").replace("#","")},getPageId(pageUrl){const links=(pageUrl||window.location.href).split("/"),result=links[links.length-1];return parseInt(result,10)||null},getCategoryId(url){if(this.isCategoryPage(url))return this.getPageId(url);if(!url){const $breadcrumbsItems=$(".breadcrumbs li");for(let i=0;i<$breadcrumbsItems.length;i+=1){const linkUrl=$breadcrumbsItems.eq(i).find("a").attr("href");if(linkUrl&&this.isCategoryPage(linkUrl))return this.getPageId(linkUrl)}}return null},getSectionId(url){if(this.isSectionPage(url))return this.getPageId(url);if(!url){const $breadcrumbsItems=$(".breadcrumbs li");for(let i=0;i<$breadcrumbsItems.length;i+=1){const linkUrl=$breadcrumbsItems.eq(i).find("a").attr("href");if(linkUrl&&this.isSectionPage(linkUrl))return this.getPageId(linkUrl)}}return null},getArticleId(url){return this.isArticlePage(url)?this.getPageId(url):null},getCurrentUser(callback){const context=this;$.getJSON("/api/v2/users/me.json").done((response=>callback.call(context,null,response.user))).fail((jqxhr=>callback.call(context,jqxhr,null)))},getArticleImages:articleBody=>$(`<div>${articleBody}</div>`).find("img").map((function(){return this.getAttribute("src")})),getUrlParameter(param){const URLVariables=window.location.search.substring(1).split("&");let parameterName,i;for(i=0;i<URLVariables.length;i+=1)if(parameterName=URLVariables[i].split("="),parameterName[0]===param)return void 0===parameterName[1]?"":decodeURIComponent(parameterName[1])},isHomePage(pageUrl){const url=pageUrl||window.location.href;return/^http(s)?:\/\/[^\/?#]+(\/hc(\/[a-z-0-9_]+)?(\/)?(signin)?([?]([^?\/]+)?)?([#]([^#\/]+)?)?)?$/.test(url)},isCategoryPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?categories\//i.test(url)},isSectionPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?sections\//i.test(url)},isArticlePage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?articles\//i.test(url)},isSearchResultsPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?search\?*.*/i.test(url)},isContributionsPostsPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?contributions\/posts(\/)?([?#].*)?$/i.test(url)},isContributionsCommunityCommentsPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?contributions\/community_comments(\/)?([?#].*)?$/i.test(url)},isContributionsCommentsPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?contributions\/comments(\/)?([?#].*)?$/i.test(url)},isFollowingPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?subscriptions(\/)?([?#].*)?$/i.test(url)},isRequestListPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?requests(\/)?([?#].*)?$/i.test(url)},isRequestPage(pageUrl){const url=pageUrl||window.location.href;return!this.isNewRequestPage(url)&&/\/hc\/([a-z-0-9_]+\/)?requests\/[^/?#]+(\/)?([?#].*)?$/i.test(url)},isNewRequestPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?requests\/new(\/)?([?#].*)?$/i.test(url)},isCommunityTopicListPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?community\/topics(\/)?([?#].*)?$/i.test(url)},isCommunityTopicPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?community\/topics\/[^\/?#]+(\/)?([?#].*)?$/i.test(url)},isCommunityPostListPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?community\/posts(\/)?([?#].*)?$/i.test(url)},isCommunityPostPage(pageUrl){const url=pageUrl||window.location.href;return!this.isNewCommunityPostPage(url)&&/\/hc\/([a-z-0-9_]+\/)?community\/posts\/[^\/?#]+(\/)?([?#].*)?$/i.test(url)},isNewCommunityPostPage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?community\/posts\/new(\/)?([?#].*)?$/i.test(url)},isUserProfilePage(pageUrl){const url=pageUrl||window.location.href;return/\/hc\/([a-z-0-9_]+\/)?profiles\/[^\/?#]+(\/)?([?#].*)?$/i.test(url)},isEndUser:user=>!(!user||!user.role||"end-user"!==user.role),hasUserTags(user,tags){return!(!user||!user.tags)&&this.findOne(tags,user.tags)},findOne:(haystack,arr)=>arr.some((v=>haystack.indexOf(v)>=0)),truncate(text,limit,clamp){const currentClamp=clamp||"...",content=(new DOMParser).parseFromString(text,"text/html").body.textContent;return content.length>limit?content.slice(0,limit)+currentClamp:content},flatten:array=>array.length?array.reduce(((prev,curr)=>prev.concat(curr))):[]};window.LotusUtils=LotusUtils}(jQuery,window,document);
